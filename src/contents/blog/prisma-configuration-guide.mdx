---
id: 9
title: "Prisma数据库工具配置与使用指南"
slug: "prisma-configuration-guide"
date: "2025-12-22"
excerpt: "详细介绍Prisma数据库工具的安装、配置和数据迁移方法，包含完整的配置示例和最佳实践"
featured_image: ""
categories: ["Database", "Tutorial"]
tags: ["Prisma", "database", "migration", "configuration", "ORM"]
is_featured: false
total_views_count: 0
---

## 初始化

```shell
# 安装prisma
pnpm i prisma@latest -D
# 初始化prisma, --datasource-provider sqlite用于指定数据库驱动为sqlite
pnpm prisma init --datasource-provider sqlite
# 生成数据库, --skip-generate表示仅创建不进行数据迁移
pnpm prisma migrate dev --name init --skip-generate
```

## 配置

在package.json中配置prisma。(**Prisma 7+后弃用**)

``` json
// package.json
{
 //...
 "prisma": {
  "schema": "path/yourproject/schema"
 },
}
```

在prisma.config.ts中配置prisma
使用prisma.config.ts时，来自.env的环境变量不会自动加载，需要先安装`dotenv`包：

1. 安装`dotenv`包:

```shell
pnpm install dotenv
```

2. 在配置文件中导入`dotenv/config`:

```ts
import "dotenv/config";
import path from "node:path";
import { fileURLToPath } from "node:url";
import { defineConfig } from "prisma/config";
// ESM中用于模拟CommonJS的__dirname
const __dirname = path.dirname(fileURLToPath(import.meta.url));

export default defineConfig({
    schema: path.join(__dirname, "src", "database", "schema", "schema.prisma"),
    migrations: {
        path: path.join(__dirname, "src", "database", "schema", "migrations"),
    },
    views: {
        path: path.join(__dirname, "src", "database", "schema", "views"),
    },
    typedSql: {
        path: path.join(__dirname, "src", "database", "schema", "queries"),
    },
});
```

## 数据迁移

通过数据迁移破坏生产环境中的数据

```shell
# 生成迁移
pnpm prisma migrate dev --create-only --skip-generate --name init
# 运行迁移
pnpm prisma db push
# 生成ts类型和方法
pnpm prisma generate
```
